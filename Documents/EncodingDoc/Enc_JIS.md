-----------------
日本語の文字エンコーディングの JISコードのテキストファイルの場合、ESCで英数字から漢字やカタカナへと切り替えますが、最初から漢字だけ、カタカナだけで、一度もESCで切り替えないテキストファイルは有り得ますか。
-----------------

はい、理論的には可能ですが、実用上はほぼあり得ません。

## JIS X 0208（ISO-2022-JP）の仕組み

JISコードでは、ファイルの**初期状態はASCII（英数字）モード**です。

- 漢字を使うには `ESC $ B`（または `ESC $ @`）でJIS X 0208に切り替え
- 半角カタカナを使うには `ESC ( I` でJIS X 0201カタカナに切り替え

## 「ESCなしで漢字だけ」が成立しない理由

初期状態がASCIIなので、**最低1回はESCシーケンスが必要**です。

例えば「日本語」とだけ書いたファイルでも：

```
ESC $ B <-- ここで漢字モードに切り替え
F|K\ <-- 「日本語」のJISコード
ESC ( B <-- ASCIIに戻す（省略されることもある）
```

## 例外的なケース

1. **空ファイル** — 文字がなければESCも不要
2. **ASCIIのみ** — 英数字だけならESC不要（でもこれは「漢字だけ」ではない）
3. **規格違反のファイル** — 初期状態をJIS X 0208と仮定する非標準実装

## 補足：EUC-JPやShift_JISとの違い

EUC-JPやShift_JISは**ステートレス**なエンコーディングで、各文字のバイト値だけで判別できるため、ESCシーケンスは不要です。JISコード（ISO-2022-JP）が**ステートフル**である点が、この切り替えが必須となる理由です。
-----------------







最後のESC ( Bが省略されることもあるのですか。
-----------------
はい、省略されることがあります。

## 省略される理由

ISO-2022-JPの規格上は、**ファイル末尾でASCIIに戻すべき**とされています。しかし実際には：

1. **ファイル終端で処理が終わる** — 読み込み側がEOFを検出すれば、その後のモードは関係ない
2. **メール本文の慣習** — 古いメールソフトでは末尾の `ESC ( B` を省略する実装があった
3. **バイト数の節約** — 昔は3バイトでも削りたい状況があった

## 省略すると問題になるケース

- **ファイルを連結したとき** — 次のファイルの先頭がASCII前提だと文字化けする
- **厳密なパーサー** — 規格準拠を求めるシステムでエラーになる可能性

```
[ファイルA: 末尾ESC省略]    [ファイルB: ASCIIで始まる]
... F|K\                    Hello
        ↑ まだ漢字モード    ↑ 漢字として解釈されて文字化け
```

## 現実の運用

RFC 1468（ISO-2022-JPのメール用規格）では、行末でASCIIに戻すことを**推奨**しています。ただ「MUST」ではなく「SHOULD」なので、省略しても規格違反とまでは言えない微妙な位置づけです。

現代のデコーダーは末尾の `ESC ( B` がなくても問題なく処理できるものがほとんどなので、実害が出ることは稀です。
-----------------







使用可能なエスケープシーケンスを全て、0x 形式の16進数で一覧してください。
-----------------
ISO-2022-JPおよび関連規格で使用されるエスケープシーケンスを一覧します。

## 基本（ISO-2022-JP / RFC 1468）

| シーケンス | 16進数 | 切り替え先 |
|-----------|--------|-----------|
| ESC ( B | `1B 28 42` | ASCII |
| ESC ( J | `1B 28 4A` | JIS X 0201 ローマ字 |
| ESC $ @ | `1B 24 40` | JIS X 0208-1978（旧JIS） |
| ESC $ B | `1B 24 42` | JIS X 0208-1983（新JIS） |

## 拡張（ISO-2022-JP-1）

| シーケンス | 16進数 | 切り替え先 |
|-----------|--------|-----------|
| ESC $ ( D | `1B 24 28 44` | JIS X 0212-1990（補助漢字） |

## 拡張（ISO-2022-JP-2 / RFC 1554）

| シーケンス | 16進数 | 切り替え先 |
|-----------|--------|-----------|
| ESC $ ( O | `1B 24 28 4F` | JIS X 0213:2000 第1面 |
| ESC $ ( P | `1B 24 28 50` | JIS X 0213:2004 第1面 |
| ESC $ ( Q | `1B 24 28 51` | JIS X 0213 第2面 |
| ESC $ A | `1B 24 41` | GB2312（中国語簡体字） |
| ESC $ ( C | `1B 24 28 43` | KS X 1001（韓国語） |
| ESC . A | `1B 2E 41` | ISO-8859-1（G2指示） |
| ESC . F | `1B 2E 46` | ISO-8859-7（ギリシャ文字、G2指示） |

## 半角カタカナ（ISO-2022-JP-3、一部実装）

| シーケンス | 16進数 | 切り替え先 |
|-----------|--------|-----------|
| ESC ( I | `1B 28 49` | JIS X 0201 カタカナ |

## 補足

- **RFC 1468（メール標準）** では最初の4つのみ規定。半角カタカナ `ESC ( I` は非推奨
- **SI / SO**（`0F` / `0E`）を使う古いISO-2022実装もあるが、ISO-2022-JPでは使用しない
- JIS X 0213系は主にISO-2022-JP-3で使用され、メールでの利用は稀
